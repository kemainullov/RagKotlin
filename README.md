# God Agent

Персональный ассистент разработчика на Kotlin. Подключается к любому проекту, индексирует его файлы через эмбеддинги и отвечает на вопросы, самостоятельно используя инструменты: читает файлы, ищет по коду, смотрит git-историю.

## Как это работает

1. При первом запуске агент обходит весь проект и строит векторный индекс файлов (RAG)
2. На каждый вопрос пользователя DeepSeek решает, какие инструменты вызвать
3. Агент выполняет инструменты (читает файлы, ищет по коду и т.д.) и отдаёт результаты обратно модели
4. Цикл повторяется до получения финального ответа (до 8 итераций)

```
Вопрос → DeepSeek → tool_calls → выполнить → DeepSeek → ... → ответ
```

## Требования

- **JDK 24**
- **Ollama** — локальный сервер эмбеддингов
- **DeepSeek API** — ключ для LLM

## Установка

**1. Установите и запустите Ollama**
```bash
# macOS
brew install ollama
ollama serve

# Скачайте модель эмбеддингов
ollama pull nomic-embed-text
```

**2. Добавьте API-ключ DeepSeek**

Создайте файл `local.properties` в корне проекта:
```
DEEPSEEK_API_KEY=sk-...
```

Или задайте переменную окружения:
```bash
export DEEPSEEK_API_KEY=sk-...
```

## Запуск

**Анализировать текущий проект (RagKotlin):**
```bash
./gradlew run
```

**Анализировать любой другой проект:**
```bash
./gradlew run --args="/path/to/your/project"
```

Например:
```bash
./gradlew run --args="/Users/username/IdeaProjects/LLMKotlin"
```

При первом запуске агент проиндексирует проект — это займёт несколько минут в зависимости от размера. Индекс сохраняется в `~/.god-agent/` и при следующих запусках загружается мгновенно.

## Команды

| Команда | Описание |
|---------|----------|
| `/help <вопрос>` | Быстрый RAG-поиск по документации (без агентного цикла) |
| `/review <файл>` | Код-ревью файла с предложениями по улучшению |
| `/analyze` | Анализ архитектуры и структуры проекта |
| `/git` | Сводка: последние коммиты и статус рабочего дерева |
| `/index` | Переиндексировать проект (после крупных изменений) |
| `очистить` | Сбросить историю диалога |
| `выход` | Завершить работу |
| `<любой вопрос>` | Агентный режим — модель сама выбирает инструменты |

## Инструменты агента

| Инструмент | Что делает |
|---|---|
| `search_docs` | Семантический поиск по индексу (RAG) |
| `read_file` | Читает содержимое файла |
| `list_dir` | Показывает содержимое директории |
| `git_info` | Ветка, последние коммиты, git status |
| `grep_code` | Поиск паттерна по исходникам |

## Структура проекта

```
├── src/main/kotlin/Main.kt   — весь код агента
├── docs/
│   ├── architecture.md       — описание архитектуры
│   └── code-style.md         — правила стиля кода
├── build.gradle.kts          — конфигурация сборки
└── local.properties          — API-ключи (не коммитить!)
```

Индексы анализируемых проектов хранятся в `~/.god-agent/` и не попадают в репозиторий.
