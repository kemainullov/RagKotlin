# FAQ — RagKotlin

## Как установить и запустить RagKotlin?

1. Клонируйте репозиторий: `git clone <url>`
2. Установите Ollama: https://ollama.ai и скачайте модель `ollama pull nomic-embed-text`
3. Укажите `DEEPSEEK_API_KEY` в файле `local.properties` или как переменную окружения
4. Запустите: `./gradlew run`

При первом запуске будет выполнена индексация документов из директории `docs/`.

## Как получить API-ключ DeepSeek?

Зарегистрируйтесь на https://platform.deepseek.com, перейдите в раздел API Keys и создайте новый ключ. Скопируйте его в `local.properties`:
```
DEEPSEEK_API_KEY=sk-ваш-ключ
```

## Почему не работает авторизация DeepSeek (ошибка 401)?

Ошибка 401 означает невалидный API-ключ. Проверьте:
- Ключ скопирован полностью, без лишних пробелов
- Ключ не истёк (проверьте на https://platform.deepseek.com/api_keys)
- Баланс аккаунта не нулевой
- В `local.properties` формат: `DEEPSEEK_API_KEY=sk-...` (без кавычек)

## Ollama не запускается или не отвечает

Убедитесь, что:
- Ollama установлена: `ollama --version`
- Сервер запущен: `ollama serve` (или запущен как системный сервис)
- Модель скачана: `ollama pull nomic-embed-text`
- Порт 11434 не занят другим процессом

Проверить работу: `curl http://localhost:11434/api/tags`

## Как переиндексировать документы?

В интерактивном режиме введите команду `/index`. Это пересканирует файлы `.txt` и `.md` из директории `docs/` и обновит `index.json`.

Также можно удалить `index.json` и перезапустить приложение — индекс будет создан заново.

## Ассистент даёт нерелевантные ответы

Возможные причины:
- Порог фильтрации слишком низкий — попробуйте увеличить threshold
- Документация не проиндексирована — выполните `/index`
- Вопрос слишком общий — попробуйте сформулировать конкретнее
- Чанки слишком мелкие или крупные — настройте `chunkSize` в `splitIntoChunks`

## Какие форматы файлов поддерживаются для индексации?

Поддерживаются файлы `.txt` и `.md` из указанных директорий. По умолчанию сканируется директория `docs/`. Также автоматически включается `README.md` из корня проекта.

## Как работает поиск по документации?

1. Вопрос пользователя преобразуется в эмбеддинг через Ollama (модель nomic-embed-text)
2. Вычисляется косинусное сходство с эмбеддингами всех чанков
3. Отбираются top-5 наиболее релевантных чанков
4. Чанки с низким сходством отсеиваются по порогу (threshold)
5. Контекст из оставшихся чанков передаётся LLM для генерации ответа

## Ошибка таймаута при запросе к DeepSeek

Таймаут запроса составляет 120 секунд. Если запрос не успевает выполниться:
- Проверьте скорость интернет-соединения
- Попробуйте уменьшить объём контекста (меньше чанков)
- Проверьте статус API на https://status.deepseek.com

## Можно ли использовать другую LLM вместо DeepSeek?

Да, можно адаптировать `DeepSeekClient` для работы с любым OpenAI-совместимым API. Измените `baseUrl` и, при необходимости, название модели в `ChatRequest`.

## Как очистить историю диалога?

Введите команду `очистить` в интерактивном режиме. История диалога (последние 5 сообщений) будет сброшена.

## Что такое MCP-интеграция?

MCP (Model Context Protocol) используется для получения контекста из внешних систем. В текущей версии функция `getCurrentGitBranch()` получает имя git-ветки и передаёт его в системный промпт ассистента, чтобы ответы учитывали контекст разработки.
